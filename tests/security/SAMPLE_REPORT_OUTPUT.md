# Sample Security Test Report Output

This document shows examples of actual security test reports generated by the system.

---

## Example 1: Critical Vulnerability - Mass Assignment

### Test Failed ❌

```markdown
# Security Test Report

## ❌ Test Result: FAIL

**Test:** Mass assignment: creating user should not allow isAdmin=true
**Timestamp:** 2025-10-22T15:41:23.456Z
**OWASP Category:** API6:2023 - Unrestricted Access to Sensitive Business Flows
**Risk Level:** 🟠 HIGH

## Description

Mass assignment vulnerabilities occur when APIs automatically bind request parameters to internal objects, allowing attackers to modify sensitive fields.

## ⚠️ Vulnerability Detected

API6:2023 - Unrestricted Access to Sensitive Business Flows

## Evidence

```json
{
  "endpoint": "/api/users",
  "request": {
    "email": "sec-test-user-123@example.com",
    "isAdmin": true
  },
  "response": {
    "id": "user-456",
    "email": "sec-test-user-123@example.com",
    "isAdmin": true,
    "createdAt": "2025-10-22T15:41:23.000Z"
  },
  "issue": "API accepted isAdmin=true and granted admin privileges"
}
```

## 📋 Recommendations

1. Use allowlists for bindable object properties
2. Never allow mass assignment of sensitive fields (isAdmin, role, etc.)
3. Validate and sanitize all input data
4. Use separate DTOs for create/update operations
5. Implement explicit field assignment instead of automatic binding

## 🔧 Remediation Steps

1. Identify all endpoints that accept object creation/updates
2. Create explicit DTOs with only allowed fields
3. Disable automatic parameter binding in your framework
4. Add validation for sensitive fields (role, permissions, etc.)
5. Use readonly decorators for fields that should never be updated
6. Add tests that attempt to modify sensitive fields
7. Review and remove any privilege escalation possibilities

## 📚 References

- https://owasp.org/API-Security/editions/2023/en/0xa6-unrestricted-access-to-sensitive-business-flows/
- https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html

---
*Generated by Security Test Reporter*
```

### Immediate Actions Required:

1. **Deploy a hotfix** to disable automatic binding of `isAdmin`, `role`, and similar fields
2. **Audit user database** to identify any users who may have escalated privileges
3. **Review access logs** for suspicious account creation activities
4. **Implement field-level validation** that rejects sensitive field assignments
5. **Add unit tests** that verify administrative fields cannot be set via API

### Timeline:

- **Hour 0-1**: Deploy emergency patch to block admin field binding
- **Hour 1-4**: Audit existing users and revoke unauthorized privileges
- **Day 1**: Implement comprehensive DTO pattern with field allowlists
- **Day 2-3**: Add automated testing for all sensitive fields
- **Week 1**: Security review of all API endpoints

---

## Example 2: High Risk - Excessive Data Exposure

### Test Failed ❌

```markdown
# Security Test Report

## ❌ Test Result: FAIL

**Test:** Excessive Data Exposure: GET user should not return sensitive fields (password)
**Timestamp:** 2025-10-22T15:42:15.789Z
**OWASP Category:** API3:2023 - Broken Object Property Level Authorization
**Risk Level:** 🟠 HIGH

## Description

APIs tend to expose sensitive object properties without proper filtering, leading to excessive data exposure.

## ⚠️ Vulnerability Detected

API3:2023 - Broken Object Property Level Authorization

## Evidence

```json
{
  "endpoint": "/api/users/123",
  "exposedFields": {
    "password": false,
    "passwordHash": true
  },
  "issue": "Sensitive password fields exposed in API response"
}
```

## 📋 Recommendations

1. Never include sensitive fields in API responses (passwords, tokens, etc.)
2. Implement response filtering based on user permissions
3. Use Data Transfer Objects (DTOs) to control exposed fields
4. Validate and sanitize all API responses
5. Document what data should be exposed for each endpoint

## 🔧 Remediation Steps

1. Audit all API responses for sensitive data exposure
2. Create serializers/DTOs that explicitly define allowed fields
3. Remove password hashes, tokens, and internal IDs from responses
4. Implement field-level authorization checks
5. Add automated tests to detect sensitive data in responses
6. Use allow-lists instead of block-lists for field exposure

## 📚 References

- https://owasp.org/API-Security/editions/2023/en/0xa3-broken-object-property-level-authorization/
- https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html

---
*Generated by Security Test Reporter*
```

### Immediate Actions Required:

1. **Remove passwordHash field** from all API response serializers
2. **Scan logs** to identify if any attackers have already harvested hashes
3. **Consider password reset** for affected users if exposure was public
4. **Implement response serializers** that explicitly define safe fields
5. **Add monitoring** for unusual authentication patterns

---

## Example 3: Critical - Injection Vulnerability

### Test Failed ❌

```markdown
# Security Test Report

## ❌ Test Result: FAIL

**Test:** Injection: basic SQL/command injection probe should not return server error or leak data
**Timestamp:** 2025-10-22T15:43:45.123Z
**OWASP Category:** API8:2023 - Security Misconfiguration
**Risk Level:** 🔴 CRITICAL

## Description

Injection flaws occur when untrusted data is sent as part of a command or query, allowing attackers to execute unintended commands.

## ⚠️ Vulnerability Detected

API8:2023 - Security Misconfiguration

## Evidence

```json
{
  "endpoint": "/api/users",
  "payload": "' OR '1'='1",
  "statusCode": 500,
  "hasStackTrace": true,
  "issue": "Server error detected with injection payload - potential SQL/command injection vulnerability"
}
```

## 📋 Recommendations

1. Use parameterized queries (prepared statements) for all database access
2. Validate and sanitize all user input
3. Implement input validation with allowlists
4. Use ORM/query builders instead of raw SQL
5. Escape special characters in user input

## 🔧 Remediation Steps

1. Replace all string concatenation in queries with parameterized queries
2. Implement input validation middleware
3. Use ORM frameworks with built-in protection
4. Add Web Application Firewall (WAF) rules
5. Implement least-privilege database access
6. Sanitize error messages to avoid information disclosure
7. Add automated SAST/DAST scanning for injection vulnerabilities
8. Review and test all data processing endpoints

## 📚 References

- https://owasp.org/API-Security/editions/2023/en/0xa8-security-misconfiguration/
- https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html
- https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html

---
*Generated by Security Test Reporter*
```

### Immediate Actions Required:

1. **URGENT**: Take affected endpoint offline immediately
2. **Audit database** for signs of unauthorized access or data exfiltration
3. **Review all code** that constructs database queries
4. **Replace all dynamic SQL** with parameterized queries or ORM
5. **Enable WAF** with SQL injection protection rules
6. **Conduct full security audit** of all endpoints

### Timeline:

- **Hour 0**: Take vulnerable endpoint offline
- **Hour 0-2**: Emergency code review and patch preparation
- **Hour 2-4**: Deploy parameterized query fixes
- **Day 1**: Full database audit and log analysis
- **Day 2-5**: Comprehensive security review of all database interactions
- **Week 1**: Implement WAF and enhanced monitoring

---

## Example 4: Warning - Missing Rate Limiting

### Test Passed with Warning ⚠️

```markdown
# Security Test Report

## ⚠️ Test Result: WARNING

**Test:** Rate limiting / DoS protections: small burst should reveal 429 or rate headers if in place
**Timestamp:** 2025-10-22T15:44:30.456Z
**OWASP Category:** API4:2023 - Unrestricted Resource Consumption
**Risk Level:** 🟢 LOW

## Description

No rate limiting detected during burst test (30 requests). This may indicate lack of DoS protection.

## 📋 Recommendations

1. Consider implementing rate limiting to prevent abuse
2. Use middleware like express-rate-limit or similar
3. Return 429 status code when limits exceeded
4. Add rate limit headers (X-RateLimit-*) to responses

---
*Generated by Security Test Reporter*
```

### Recommended Actions:

1. **Evaluate risk**: Determine if endpoints are public-facing and require protection
2. **Implement rate limiting**: Add middleware to limit requests per IP/user
3. **Configure appropriate limits**: Based on expected traffic patterns
4. **Add monitoring**: Track request rates and identify potential attacks
5. **Document policy**: Define rate limits in API documentation

### Sample Implementation (Express.js):

```javascript
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100, // limit each IP to 100 requests per windowMs
  standardHeaders: true,
  legacyHeaders: false,
  handler: (req, res) => {
    res.status(429).json({
      error: 'Too many requests',
      retryAfter: Math.ceil(req.rateLimit.resetTime / 1000)
    });
  }
});

app.use('/api/', limiter);
```

---

## Example 5: Warning - Missing Security Headers

### Test Passed with Warning ⚠️

```markdown
# Security Test Report

## ⚠️ Test Result: WARNING

**Test:** Security headers and server fingerprinting
**Timestamp:** 2025-10-22T15:45:00.789Z
**OWASP Category:** API7:2023 - Server Side Request Forgery
**Risk Level:** 🟢 LOW

## Description

Missing 4 security headers: Content-Security-Policy, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security. Server fingerprinting detected: Express/4.18.2

## 📋 Recommendations

1. Add Content-Security-Policy header to prevent XSS attacks
2. Add X-Frame-Options header to prevent clickjacking
3. Add X-Content-Type-Options: nosniff to prevent MIME sniffing
4. Add Strict-Transport-Security header to enforce HTTPS
5. Remove or obscure Server and X-Powered-By headers to prevent fingerprinting

---
*Generated by Security Test Reporter*
```

### Recommended Actions:

1. **Add security headers middleware**
2. **Configure CSP policy** appropriate for your application
3. **Enable HSTS** if using HTTPS (should be!)
4. **Remove server version headers**
5. **Test with security scanning tools**

### Sample Implementation (Express.js):

```javascript
const helmet = require('helmet');

app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"],
    },
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  },
  frameguard: {
    action: 'deny'
  },
  noSniff: true
}));

// Remove server fingerprinting
app.disable('x-powered-by');
```

---

## Example 6: Test Passed Successfully ✅

### All Checks Passed ✅

```markdown
# Security Test Report

## ✅ Test Result: PASS

**Test:** Mass assignment: creating user should not allow isAdmin=true
**Timestamp:** 2025-10-22T15:46:00.123Z
**OWASP Category:** API6:2023 - Unrestricted Access to Sensitive Business Flows

## Description

Mass assignment protection verified: API correctly rejected or ignored isAdmin=true parameter

---
*Generated by Security Test Reporter*
```

**Status**: No action required. Security control is working as expected.

---

## Example 7: Test Skipped ⏭️

### Test Could Not Run ⏭️

```markdown
# Security Test Report

## ⏭️ Test Result: SKIP

**Test:** Mass assignment: creating user should not allow isAdmin=true
**Timestamp:** 2025-10-22T15:46:30.456Z
**OWASP Category:** N/A

## Description

Test skipped: No user-create endpoint found to test mass assignment

---
*Generated by Security Test Reporter*
```

**Status**: Test could not complete. This may indicate:
- Endpoint doesn't exist (intentional)
- Endpoint path differs from expected patterns
- Application structure differs from test assumptions

**Action**: Review if this test is applicable to your API. If yes, configure the correct endpoint paths.

---

## Summary Dashboard Example

### Overall Security Posture

```
╔═══════════════════════════════════════════════════════════════╗
║           Security Test Results - Bank API                     ║
╠═══════════════════════════════════════════════════════════════╣
║ Date: 2025-10-22                                              ║
║ Total Tests: 5                                                ║
║                                                               ║
║ ✅ Passed:    2                                                ║
║ ❌ Failed:    1                                                ║
║ ⚠️  Warnings: 2                                                ║
║ ⏭️  Skipped:  0                                                ║
╠═══════════════════════════════════════════════════════════════╣
║ Vulnerabilities by Severity:                                  ║
║                                                               ║
║ 🔴 CRITICAL: 0                                                 ║
║ 🟠 HIGH:     1 (Excessive Data Exposure)                       ║
║ 🟡 MEDIUM:   0                                                 ║
║ 🟢 LOW:      2 (Rate Limiting, Security Headers)               ║
╠═══════════════════════════════════════════════════════════════╣
║ OWASP Coverage:                                               ║
║                                                               ║
║ ✅ API1 - Broken Object Level Authorization                    ║
║ ❓ API2 - Broken Authentication                                ║
║ ❌ API3 - Broken Object Property Level Auth     [HIGH RISK]   ║
║ ⚠️  API4 - Unrestricted Resource Consumption    [LOW RISK]    ║
║ ✅ API5 - Broken Function Level Authorization                  ║
║ ✅ API6 - Mass Assignment Protection                           ║
║ ⚠️  API7 - Security Misconfiguration            [LOW RISK]    ║
║ ✅ API8 - Injection Protection                                 ║
║ ❓ API9 - Improper Inventory Management                        ║
║ ❓ API10 - Unsafe API Consumption                              ║
╠═══════════════════════════════════════════════════════════════╣
║ Recommended Priority Actions:                                 ║
║                                                               ║
║ 1. [HIGH] Fix data exposure in /api/users endpoint           ║
║ 2. [LOW] Implement rate limiting                             ║
║ 3. [LOW] Add security headers                                ║
╚═══════════════════════════════════════════════════════════════╝
```

---

## Integration with Playwright HTML Reporter

When you run `npx playwright show-report`, you'll see:

1. **Test List**: All security tests with pass/fail status
2. **Attachments**: Click on any test to view the detailed security report
3. **Annotations**: Tests with vulnerabilities are marked with security annotations
4. **Timeline**: See how long each test took
5. **Screenshots**: If visual verification was used
6. **Traces**: Full execution trace for debugging

### Accessing Reports:

```bash
# Run tests
npx playwright test tests/security/

# Open HTML report
npx playwright show-report

# Navigate to:
# - Click on any failed test
# - Look for "Attachments" section
# - Click on "security-report-*.md" to view the full report
```

---

## Automated Reporting in CI/CD

### Example GitHub Actions Output:

```
Security Tests Summary:
✅ 2 passed
❌ 1 failed  
⚠️ 2 warnings
⏭️ 0 skipped

Failed Tests:
  - Excessive Data Exposure: GET user should not return sensitive fields
    Risk: HIGH
    OWASP: API3:2023
    Report: artifacts/security-report-1234.md

Warnings:
  - Rate limiting / DoS protections
    Risk: LOW
    OWASP: API4:2023
    
  - Security headers and server fingerprinting
    Risk: LOW
    OWASP: API7:2023

📊 Full Report: https://github.com/yourorg/repo/actions/runs/123456/artifacts
```

---

**Note**: All examples are illustrative. Actual reports will vary based on your API implementation and test results.
